---
title: "postgresqlã«æ¥ç¶šã™ã‚‹ã¨SSLãŒæœ‰åŠ¹ã«ãªã£ã¦ãªã„ãŸã‚å¼¾ã‹ã‚Œã‚‹å ´åˆã®å¯¾å‡¦æ–¹æ³•"
emoji: "ğŸˆ"
type: "tech"
topics:
  - "go"
  - "postgresql"
  - "golang"
published: true
published_at: "2022-10-30 17:38"
---

# ã¯ã˜ã‚ã«

`golang-migrate` ã§`postgresql`ã«æ¥ç¶šã—ã¦`migrate`ã‚’è©¦ã¿ãŸã¨ã“ã‚ã€ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã€‚

èª¿ã¹ãŸã¨ã“ã‚ã€`postgres`ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ `SSL` ã‚’æœ‰åŠ¹ã«ã—ãªã„ãŸã‚ã«èµ·ã“ã‚‹ã¨ã®ã“ã¨ã ã£ãŸã®ã§å¯¾å‡¦æ–¹æ³•ã‚’ã¾ã¨ã‚ã‚‹ã€‚

```bash
migrate -path db/migration -database "postgresql://username:password@localhost:5432/dbname" -verbose up
2022/10/30 17:19:16 error: pq: SSL is not enabled on the server
```

https://www.postgresql.jp/docs/9.2/libpq-ssl.html

https://github.com/golang-migrate/migrate/tree/master/cmd/migrate

# å¯¾å‡¦æ–¹æ³•

`?sslmode=disable`ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹URLã«è¿½åŠ ã™ã‚‹ã“ã¨ã§æ¥ç¶šãŒå¯èƒ½ã«ãªã‚Šã¾ã™

```bash
migrate -path db/migration -database "postgresql://username:password@localhost:5432/dbname?sslmode=disable" -verbose up

2022/10/30 17:21:06 Start buffering 1/u init_schema
2022/10/30 17:21:06 Read and execute 1/u init_schema
2022/10/30 17:21:06 Finished 1/u init_schema (read 9.189788ms, ran 32.894114ms)
2022/10/30 17:21:06 Finished after 50.370077ms
2022/10/30 17:21:06 Closing source and database
```