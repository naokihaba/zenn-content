---
title: "ã€NestJSã€‘ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§èª­ã¿è¾¼ã‚€æ–¹æ³•"
emoji: "ðŸ—‚ï¸"
type: "tech"
topics:
  - "typescript"
  - "nestjs"
  - "module"
published: true
published_at: "2022-03-22 03:53"
---

# æ¦‚è¦
ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§èª­ã¿è¾¼ã‚€æ–¹æ³•ã‚’ã¾ã¨ã‚ã‚‹

https://docs.nestjs.com/techniques/configuration

# ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm i --save @nestjs/config
```

# ã‚«ã‚¹ã‚¿ãƒ æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®šç¾©

```typescript:config/configuration.ts
export default () => ({
  nodeEnv: process.env.NODE_ENV || 'development',
  server: {
    port: parseInt(process.env.PORT) || 3000,
    hostName: process.env.hostname || 'localhost:3000',
  },
  database: {
    host: process.env.DB_HOST || 'localhost',
    port: parseInt(process.env.DB_PORT) || 5432,
    user: process.env.DB_USERNAME || 'root',
    pass: process.env.DB_PASSWORD || 'password',
    name: process.env.DB_NAME || 'sample',
  },
  auth: {
    jwt_secret_key:
      'Bearer xxxxx',
    hashSalt: 10,
  },
})
```

# ãƒ¡ã‚¤ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§èª­ã¿è¾¼ã‚€

```ts:src/app.module.ts
@Module({
  imports: [
    ConfigModule.forRoot({
      // ã‚°ãƒ«ãƒ¼ãƒãƒ«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã™ã‚‹
      isGlobal: true,
      
      // ã‚«ã‚¹ã‚¿ãƒ æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ 
      load: [configuration],
    }),
    TypeOrmModule.forRootAsync({
      imports: [ConfigModule],
      useFactory: (configService: ConfigService) => ({
        type: 'mysql',
        host: configService.get('database.host'),
        port: Number(configService.get('database.port')),
        username: configService.get('database.user'),
        password: configService.get('database.pass'),
        database: configService.get('database.name'),
        entities: [join(__dirname + '/domain/entities/*.entity{.ts,.js}')],
        extra: {},
      }),
      inject: [ConfigService],
    }),
  ],
  controllers: [AppController],
  providers: [AppService],
})
export class AppModule {
  configure(consumer: MiddlewareConsumer) {
    consumer.apply(LoggerMiddleware, OemSettingMiddleware).forRoutes('')
  }
}

```
