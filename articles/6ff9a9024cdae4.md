---
title: "Pinia å…¥é–€"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [ 'pinia', 'javaScripy' ]
published: false
---

# ã¯ã˜ã‚ã«

Vue3 ã‹ã‚‰çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ Pinia ãŒå…¬å¼ã«æ¨å¥¨ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

Pinia ã¯ Vuex ã®ä»£æ›¿ã¨ã—ã¦ä½ç½®ã¥ã‘ã‚‰ã‚Œã€ã‚ˆã‚ŠæŸ”è»Ÿã§ã‚·ãƒ³ãƒ—ãƒ«ãªçŠ¶æ…‹ç®¡ç†ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚

ã“ã®è¨˜äº‹ã§ã¯ã€Pinia ã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

# Pinia ã¨ã¯

Pinia ã¯ 2019å¹´11æœˆé ƒã«ã€Composition API ã‚’ä½¿ã£ã¦ Vuex ã®ä»£æ›¿ã¨ã—ã¦é–‹ç™ºãŒå§‹ã¾ã‚Šã¾ã—ãŸã€‚

ä¸»ãªç‰¹å¾´ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

- TypeScript ã«å¯¾å¿œ
- Composition API ã«å¯¾å¿œ
- Vue Devtools ã«å¯¾å¿œ
- SSR ã«å¯¾å¿œ

## Vuex ã¨ Pinia ã®é•ã„

Vuex ã¨ Pinia ã¯ã€ã¨ã‚‚ã« Vue.js ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ãŒã€Store ã®è¨­è¨ˆæ€æƒ³ã«å¤§ããªé•ã„ãŒã‚ã‚Šã¾ã™ã€‚

### Store ã®æ§‹æˆ

- Vuex: 1ã¤ã® Store ã«è¤‡æ•°ã® Module ã‚’ç™»éŒ²ã™ã‚‹
- Pinia: Store ã”ã¨ã« Module ã‚’å®šç¾©ã™ã‚‹

Vuex ã§ã¯ã€1ã¤ã® Store ã«è¤‡æ•°ã® Module ã‚’ç™»éŒ²ã—ã€å…¨ä½“ã§ãƒ„ãƒªãƒ¼æ§‹é€ ã‚’å½¢æˆã—ã¾ã™ã€‚

ä¸€æ–¹ã€Pinia ã§ã¯ Store ã”ã¨ã« Module
ã‚’å®šç¾©ã—ã€ãƒ•ãƒ©ãƒƒãƒˆãªæ§‹é€ ã«ãªã‚Šã¾ã™ã€‚

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®æ¯”è¼ƒ

Vuex ã§ã¯ã€actions.jsã€mutations.jsã€modules ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½¿ã£ã¦ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆ†é›¢ã—ã¾ã™ã€‚

å¯¾ç…§çš„ã«ã€Pinia ã§ã¯å„ Storeï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ãŒãã‚Œãã‚Œã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å®šç¾©ã•ã‚Œã¾ã™ã€‚

```shell
# Vuex
â””â”€â”€ store
    â”œâ”€â”€ index.js          # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’é›†ã‚ã¦ã‚¹ãƒˆã‚¢ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹
    â”œâ”€â”€ actions.js        # ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
    â”œâ”€â”€ mutations.js      # ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
    â””â”€â”€ modules
        â”œâ”€â”€ cart.js       # cart ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
        â””â”€â”€ products.js   # products ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
        
# Pinia
â””â”€â”€ stores
    â”œâ”€â”€ index.ts          # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’é›†ã‚ã¦ã‚¹ãƒˆã‚¢ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹
    â”œâ”€â”€ cart.ts           # cart ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
    â””â”€â”€ products.ts       # products ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
```

### çŠ¶æ…‹å¤‰æ›´ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

- Vuex: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ â†’ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ â†’ ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ â†’ çŠ¶æ…‹å¤‰æ›´
- Pinia: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ â†’ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ â†’ çŠ¶æ…‹å¤‰æ›´

Vuex ã§ã¯ã€çŠ¶æ…‹ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã«ã¯ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’çµŒç”±ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€DevTools ã§ã®çŠ¶æ…‹å¤‰æ›´ã®è¿½è·¡ã¨ã€ä¸€å®šã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä¿ƒã™ãŸã‚ã§ã™ã€‚

ä¸€æ–¹ã€Pinia ã§ã¯ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¦‚å¿µãŒãªããªã‚Šã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ç›´æ¥çŠ¶æ…‹ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ¼ãƒ‰ãŒã‚·ãƒ³ãƒ—ãƒ«ã«ãªã‚Šã€é–‹ç™ºè€…ã®è‡ªç”±åº¦ãŒä¸ŠãŒã‚Šã¾ã™ã€‚

ã¾ãŸã€Pinia ã® DevTools çµ±åˆã«ã‚ˆã‚Šã€ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãªã—ã§ã‚‚çŠ¶æ…‹å¤‰æ›´ã®è¿½è·¡ãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚

### Mutation ãŒä¸è¦ã¨ã•ã‚ŒãŸèƒŒæ™¯

èƒŒæ™¯ã‚’èª¿æŸ»ã—ãŸã¨ã“ã‚ã€[Issues](https://github.com/vuejs/pinia/issues/58) ã§ã€Pinia ã®é–‹ç™ºè€…ãŒæ¬¡ã®ã‚ˆã†ã«è¿°ã¹ã¦ã„ã¾ã™

> After many years using Vuex, most mutations were completely unnecessary as they were merely doing a single operation
> via an assignment (=) or collection methods like push.

ã¤ã¾ã‚Šã€Vuex ã‚’é•·å¹´ä½¿ç”¨ã—ãŸçµŒé¨“ã‹ã‚‰ã€ã»ã¨ã‚“ã©ã®ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒå˜ä¸€ã®ä»£å…¥æ“ä½œï¼ˆ=ï¼‰ã‚„ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆpushãªã©ï¼‰ã‚’è¡Œã†ã ã‘ã§ã€å®Œå…¨ã«ä¸è¦ã§ã‚ã‚‹ã“ã¨ã‚’ç™ºè¦‹ã—ãŸã¨ã„ã†ã“ã¨ã§ã™ã€‚

ã“ã®ãŸã‚ã€Pinia ã§ã¯ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å»ƒæ­¢ã—ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ç›´æ¥çŠ¶æ…‹ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€é–‹ç™ºè€…ã®è² æ‹…ã‚’è»½æ¸›ã—ã¾ã—ãŸã€‚

# Pinia ã®åŸºæœ¬çš„ãªä½¿ã„æ–¹

ã“ã“ã‹ã‚‰ã€Pinia ã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

æ—¢ã« Vue3 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãƒ»Pinia ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¾ã™ã€‚

[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://pinia.vuejs.org/getting-started.html) ã‚’å‚ç…§ã—ã¦ã€Pinia ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚

## Vue3 + Pinia ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

Vue3 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã« Pinia ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹æ‰‹é †ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

- `createPinia` é–¢æ•°ã‚’ä½¿ã£ã¦ Pinia ã‚’åˆæœŸåŒ–
- `createApp` é–¢æ•°ã« `createPinia` ã‚’è¿½åŠ 
- `mount` é–¢æ•°ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒã‚¦ãƒ³ãƒˆ

ã“ã®æ‰‹é †ã‚’å®Ÿè£…ã™ã‚‹ã¨ã€Vue3 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã« Pinia ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚

```javascript
// main.js

import { createApp } from 'vue'
import App from './App.vue'
import { createPinia } from 'pinia'

createApp(App)
    .use(createPinia()) // Pinia ã‚’åˆæœŸåŒ–ã—ã¦ Vue3 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è¿½åŠ 
    .mount("#app");
```

## Store ã®å®šç¾©

Store ã‚’å®šç¾©ã™ã‚‹æ‰‹é †ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

- `defineStore` é–¢æ•°ã‚’ä½¿ã£ã¦ Store ã‚’å®šç¾©
- `state` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«çŠ¶æ…‹ã‚’å®šç¾©
- `actions` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®šç¾©
- `getters` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚²ãƒƒã‚¿ãƒ¼ã‚’å®šç¾©

```javascript
// stores/ProductStore.js
import { defineStore } from "pinia"

export const useProductStore = defineStore("ProductStore", {
    state: () => {
        return {
            products: []
        }
    },

    actions: {
        async fill() {
            this.products = (await import("../data/products")).default
        }
    }
})

// Action ã‚’å‘¼ã³å‡ºã™
// hoge.vue
const productStore = useProductStore()
productStore.fill()
```

## `$patch` ã§çŠ¶æ…‹ã‚’æ›´æ–°

`$patch` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€è¤‡æ•°ã®çŠ¶æ…‹å¤‰æ›´ã‚’ä¸€åº¦ã«è¡Œã†ã“ã¨ãŒã§ãã€ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚·ã‚¹ãƒ†ãƒ ãŒåŠ¹ç‡çš„ã«æ›´æ–°ã‚’è¡Œã„ã¾ã™ã€‚

ãŸã ã—ã€å˜ä¸€ã®ä»£å…¥æ“ä½œã‚„å˜ç´”ãªçŠ¶æ…‹å¤‰æ›´ã®å ´åˆã¯ã€$patch ã‚’ä½¿ã‚ãšã«ç›´æ¥çŠ¶æ…‹ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚

```javascript
export const useUserStore = defineStore('user', {
    state: () => ({
        name: 'John Doe',
        email: 'john@example.com',
        age: 30
    }),
    actions: {
        updateUser(userData) {
            this.$patch({
                name: userData.name,
                email: userData.email,
                age: userData.age
            })
        },
        incrementAge() {
            this.$patch((state) => {
                state.age++
            })
        }
    }
})
```

## `getters` ã®å®šç¾©

`getters` ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå ´åˆã«ä¾¿åˆ©ã§ã™ã€‚

- è¤‡æ•°ã®çŠ¶æ…‹ã‚’çµ„ã¿åˆã‚ã›ã¦æ–°ã—ã„å€¤ã‚’ç®—å‡ºã™ã‚‹
- ç®—å‡ºã—ãŸå€¤ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ã„ãŸã„
- ç®—å‡ºã—ãŸå€¤ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¦å†è¨ˆç®—ã‚’é˜²ããŸã„
- ç®—å‡ºã—ãŸå€¤ã‚’ã‚¹ãƒˆã‚¢å†…ã§å…±æœ‰ã—ãŸã„

`getters` ã‚’ä½¿ã†ã¨ã€ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã‚’è¿”ã™ã“ã¨ãŒã§ãã‚‹ã®ã§ã€Store ã®çŠ¶æ…‹ãŒå¤‰æ›´ã•ã‚Œã‚‹ã¨è‡ªå‹•çš„ã«å†è¨ˆç®—ã•ã‚Œã¾ã™ã€‚

```javascript
export const useUserStore = defineStore('user', {
    state: () => ({
        firstName: 'John',
        lastName: 'Doe',
    }),
    getters: {
        fullName: (state) => `${state.firstName} ${state.lastName}`,
    },
})
```

### `$reset` ãƒ¡ã‚½ãƒƒãƒ‰

`$reset` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã†ã¨ã€Store ã®çŠ¶æ…‹ã‚’åˆæœŸå€¤ã«ãƒªã‚»ãƒƒãƒˆã§ãã¾ã™ã€‚

```javascript
export const useCounterStore = defineStore('counter', {
    state: () => ({
        count: 0,
        name: 'Counter',
    }),
    actions: {
        increment() {
            this.count++
        },
        reset() {
            this.$reset()
        },
    },
})
```

## `Store` ã‹ã‚‰ åˆ¥ã® `Store` ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹

`Store` ã‹ã‚‰åˆ¥ã® `Store` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å ´åˆã¯ã€`useOtherStore` ã‚’ä½¿ã£ã¦ä»–ã® `Store` ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

```javascript
import { defineStore } from 'pinia'
import { useOtherStore } from './other-store'

export const useMyStore = defineStore('myStore', {
    // ...
    actions: {
        async myAction() {
            const otherStore = useOtherStore()
            // otherStore ã‚’ä½¿ã£ãŸå‡¦ç†
        },
    },
})
```

`$pinia` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ã£ã¦ã€ä»–ã® `Store` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```javascript
import { defineStore } from 'pinia'

export const useMyStore = defineStore('myStore', {
    // ...
    actions: {
        async myAction() {
            const otherStore = this.$pinia.use('otherStore')
            // otherStore ã‚’ä½¿ã£ãŸå‡¦ç†
        },
    },
})
```

## `Options API` ã§ã® `Store` ã®ä½¿ã„æ–¹

Pinia ã¯ã€Options API ã¨ä¸€ç·’ã«ä½¿ã†ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

mapState ã¨ mapWritableState ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¹ãƒˆã‚¢ã®çŠ¶æ…‹ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

- `mapState` ã§ Store ã®å€¤ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«èª­ã¿å–ã‚Šå°‚ç”¨ã§ãƒãƒƒãƒ”ãƒ³ã‚°
- `mapWritableState` ã§ Store ã®å€¤ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«èª­ã¿æ›¸ãå¯èƒ½ã§ãƒãƒƒãƒ”ãƒ³ã‚°å¯èƒ½ã§ã€`v-model` ã‚’ä½¿ã£ã¦åŒæ–¹å‘ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã§ãã¾ã™ã€‚

```vue

<script>
  import { mapState, mapWritableState } from 'pinia'
  import { useAuthUserStore } from '@/stores/auth-user'
  import CartWidget from '@/components/CartWidget.vue'

  export default {
    components: {
      CartWidget
    },
    computed: {
      ...mapState(useAuthUserStore, {
        username: (store) => store.username
      }),
      ...mapWritableState(useAuthUserStore, [ 'email' ]),
      greeting: function () {
        return `Hello, ${this.username}!`
      }
    }
  }
</script>

<template>
  <input type="text" v-model="email"/>
  <span class="mr-5">{{ greeting }}</span>
  <CartWidget/>
</template>
```

## `Options API` ã§ã® `Store` ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ä½¿ã„æ–¹

`mapActions` ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¹ãƒˆã‚¢ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```javascript
export const useAuthUserStore = defineStore("AuthUserStore", {
    state: () => {
        return {
            username: "John Doe"
        }
    },
    actions: {
        visitTwitterProfile() {
            window.open("https://twitter.com/" + this.username, "_blank")
        }
    }
})
```

```vue

<script>
  export default {
    methods: {
      ...mapActions(useAuthUserStore, {
        toTwitter: "visitTwitterProfile"
      })
    }
  }
</script>

<template>
  <span class="mr-5" @click="toTwitter">{{ user }}</span>
</template>
```

### HMR (Hot Module Replacement)

https://pinia.vuejs.org/cookbook/hot-module-replacement.html

Pinia ã¯ã€HMRï¼ˆHot Module Replacementï¼‰ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚

- HMRã¯ã€é–‹ç™ºä¸­ã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãŸã¨ãã«ã€ãã®å¤‰æ›´ã‚’å³åº§ã«ãƒ–ãƒ©ã‚¦ã‚¶ã«åæ˜ ã•ã›ã‚‹ãŸã‚ã®æ©Ÿèƒ½
- å…¨ä½“ã®ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰ã‚’è¡Œã‚ãšã«ã€å¤‰æ›´ã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã ã‘ã‚’æ›´æ–°ã§ãã‚‹
- `import.meta.hot` ã§ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ©ï¼ˆã“ã®å ´åˆã¯Vite.jsï¼‰ãŒ HMR ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèª

```javascript
if (import.meta.hot) {
    import.meta.hot.accept(acceptHMRUpdate(useCartStore, import.meta.hot))
}

// [vite] hot updated: /src/stores/CartStore.js
```

### Subscribing to actions

https://pinia.vuejs.org/core-concepts/actions.html

- `store.$onAction()` ã§ Store ã® Action å®Ÿè¡Œã‚’ç›£è¦–

```javascript
const cartStore = useCartStore()

cartStore.$onAction((
    {
        name, // name of the action
        store, // store instance, same as `someStore`
        args, // array of parameters passed to the action
        after, // hook after the action returns or resolves
        onError // hook if the action throws or rejects
    }) => {
    if (name === 'addItems') {
        // this will trigger if the action succeeds and after it has fully run
        after(() => {
            console.log(`Added ${args[0]} ${args[1].name} to cart`)
        })

        // this will trigger if the action throws or returns a promise that rejects
        onError((error) => {
            console.warn(`Failed to add ${args[0].quantity} ${args[1].name} to cart`, error)
        })
    }
})
```

# å‚è€ƒæ–‡çŒ®

- [The friendlier alternative to Vuex in Vue 3](https://rubenr.dev/pinia-vuex/)
- [Issues](https://github.com/vuejs/pinia/issues/58) 