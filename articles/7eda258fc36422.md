---
title: "ç§˜å¯†éµãƒ»CSRï¼Ÿã¨ã„ã†ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«å‘ã‘ãŸHOWTO"
emoji: "ğŸ“˜"
type: "tech"
topics:
  - "gcp"
  - "key"
  - "å‚™å¿˜éŒ²"
  - "ssl"
  - "csr"
published: true
published_at: "2021-12-05 00:55"
---

# æ¦‚è¦
â€‹
SSLã®ç®¡ç†ã‚’ã—ã¦ã„ã‚‹ã®ã§ã‚‚ã†ï¼‘æ­©å…ˆã®çŸ¥è­˜ã‚’å¾—ã‚‹ãŸã‚ã«æŠ€è¡“æ›¸ã‚’è³¼å…¥ã—ã¾ã—ãŸã€‚
ä»Šå›ã¯ä»¥ä¸‹ã®æŠ€è¡“æ›¸ã‚’ãƒ™ãƒ¼ã‚¹ã«å‚™å¿˜éŒ²ã¨ã—ã¦ã¾ã¨ã‚ã¦ã„ãã¾ã™
https://booth.pm/ja/items/1834443

# ã“ã®è¨˜äº‹ã®ã‚´ãƒ¼ãƒ«
â‘ GCPã§ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¦ã‚‹
â‘¡Nginxã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
â‘¢ç§˜å¯†éµãƒ»CSRã‚’ä½œæˆã™ã‚‹

# SSHã®ç§˜å¯†éµãƒ»å…¬é–‹éµã‚’ä½œæˆã™ã‚‹

```bash:bash
# ä»»æ„ã®å…¬é–‹éµãƒ»ç§˜å¯†éµã‚’ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¾ã¨ã‚ã¾ã™
mkdir /Documents/ssl && cd /Documents/ssl

# -N ãƒ‘ã‚¹ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’æŒ‡å®š -f ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹
ssh-keygen -N '' -f ~/Desktop/practice/ssl/startSSLkey

ls
# ç§˜å¯†éµ         # å…¬é–‹éµ 
startSSLkey	startSSLkey.pub

# ã‚ªãƒ¼ãƒŠãƒ¼ã«ã®ã¿èª­ã¿æ›¸ãæ¨©é™ã‚’ä»˜ä¸ã—ã¾ã™
chmod 600 startSSLkey

# å…¬é–‹éµã‚’è¡¨ç¤º(å¾Œã»ã©ä½¿ç”¨ã™ã‚‹ã®ã§ãƒ¡ãƒ¢å¸³ã«æ§ãˆã¾ã™ï¼‰
view startSSLkey.pub
```

# VMã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ§‹ç¯‰ã—ã¾ã™

https://qiita.com/Brutus/items/22dfd31a681b67837a74

# æ§‹ç¯‰ã—ãŸVMã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«SSHã§æ¥ç¶šã—ã¾ã™

![](https://storage.googleapis.com/zenn-user-upload/500bc5c8fc9f-20211204.png)


# Nginxã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash:bash

# rootæ¨©é™ã«åˆ‡ã‚Šæ›¿ãˆã¾ã™
sudo su -

# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¸€è¦§ã‚’æ›´æ–°
apt update

# nginxã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
apt install nginx

# ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¡¨ç¤º
nginx -v
nginx version: nginx/1.10.3 (Ubuntu)
```


# ç§˜å¯†éµã‚’ä½œæˆ

```bash:bash
# ç§˜å¯†éµã‚’ä½œæˆ
openssl genrsa -out /etc/nginx/ssl/startssl.key 2048

root@instance-1:/etc/nginx/ssl# ls
startssl.key

# ç®¡ç†è€…ã«ã®ã¿èª­ã¿æ›¸ãã‚’è¨±å¯ã™ã‚‹
chmod 600 /etc/nginx/ssl/startssl.key 
```

# CSR(è¨¼æ˜æ›¸ç½²åãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼‰ã‚’ä½œæˆ

```bash:bash
openssl req -new -key startssl.key -out startssl.csr
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----

# å›½å
Country Name (2 letter code) [AU]:JP 
# éƒ½é“åºœçœŒå
State or Province Name (full name) [Some-State]:Tokyo
# å¸‚åŒºç”ºæ‘å
Locality Name (eg, city) []:Shibuya
# çµ„ç¹”å
Organization Name (eg, company) [Internet Widgits Pty Ltd]:system
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:hogedns.com
Email Address []:
Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:
An optional company name []:
root@instance-1:/etc/nginx/ssl# ls
```


https://weblabo.oscasierra.net/openssl-gencert-1/

# æœ€å¾Œã«
èª­ã‚“ã§ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚
ä»Šå›ã®è¨˜äº‹ã¯ã„ã‹ãŒã§ã—ãŸã‹ï¼Ÿ
ãƒ»ã“ã†ã„ã†è¨˜äº‹ãŒèª­ã¿ãŸã„
ãƒ»ã“ã†ã„ã†ã¨ã“ã‚ãŒè‰¯ã‹ã£ãŸ
ãƒ»ã“ã†ã—ãŸæ–¹ãŒè‰¯ã„ã®ã§ã¯ãªã„ã‹
ãªã©ãªã©ã€ç‡ç›´ãªã”æ„è¦‹ã‚’å‹Ÿé›†ã—ã¦ãŠã‚Šã¾ã™ã€‚
